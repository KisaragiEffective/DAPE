# ドメイン名に関するガイドライン

このガイドラインでは、開発・ドキュメント記述・コンフィグレーションファイルのデフォルト値において任意に選択することが可能なドメイン名を選定する際の基準を示す。

## 用語の定義

本ガイドラインで次の用語を見かけた際は、当該用語に右記された解釈で読解するものとする。

1. 「禁止」は絶対に使用してはならないことを示す。
2. 「非推奨」は特段の理由がない限り避けるべきことを示す。
3. 「推奨」は積極的に利用することを示す。

## 規則

### 0. 一般に割当を受けることができる TLD を例示用として使わない

`.com` や `.net` など、誰でも登録できる汎用TLDを例示に用いることは禁止する。
ドキュメントや設定ファイルを参照したユーザーが、そのドメインの意図を確認しようとして、誤って悪意のあるサイトにアクセスしてしまうリスクがあるためである。

代案としては、後述する例示用TLD（`.example` など）の使用を推奨する。

### 1. 実在するドメイン名を使わない

例示においては、すでに登録されているドメイン名を利用することは不適当であるため、使用を禁止する。

※例外：すでに存在するサーバーを一意に指し示す目的に限っては、実在するドメイン名を使用すること。

### 2. local TLD を使わない

`.local` TLD は予約されていない。しかし、 mTLS 関連で思わぬ遅延を引き起こすことがあるため選定は非推奨である。

関連: [ローカル開発環境用に独自のドメインを用意するなら .local を末尾にしちゃだめ](https://techblog.hacomono.jp/entry/2025/06/10/110000)

### 3. corp、mail、home TLD を使わない

これらはすでにICANNにおいて採択が棄却されているため、実際に有効なドメイン名が割り当てられることはない。

また、例示用であっても明示的に例示用として予約されたTLDが存在するため、非推奨である。

### 4. `docker.internal` を使わない

Docker を用いた開発環境で衝突して不都合であるため、 `docker.internal` をドメイン名として選定するのは禁止する。

関連: <https://docs.docker.jp/desktop/networking.html#desktop-networking-i-want-to-connect-from-a-container-to-a-service-on-the-host>

### 5. ブランドTLDを使わない

通常の場合において、我々がブランドTLD配下のドメインを割り当てられることは想定されない。

そのため、例示・開発用途にブランドTLDを使用することは不適切である。よって、ブランドTLDを持つドメインの使用は禁止する。

例: `.sharp` はシャープ社が権利を保有するブランドTLDであるため、使用を禁止する。

### 6. 例示のためには例示用ドメインとして予約されたドメインを用いる

例示のためには[IETF RFC 2606]において例示用ドメインとして予約されている `.example` TLDを用いることを推奨する。

※背景: ccTLDやgTLDが提供する例示用ドメイン (例: `example.com`[^1] や `example.jp`[^2] ) は例示用ドメインとしてよく使用されているが、今後何らかの都合で例示用でなくなる可能性があるため。

例: `dape.example`

### 7. テストで使用するドメインは `.test` とする

テストで使用・参照するドメインのTLDは[IETF RFC 2606]において例示用ドメインとして予約されている `.test` TLD を持つドメインを用いることを推奨する。

#### 7.1. テストで使用するドメインの命名規則

原則、`[ユニット名].[アプリケーション名].test` のフォーマットにする。しかし、`[ユニット名]` に `.` を含めて良い。なぜなら、必要に応じて、 `[サブユニット名].[ユニットカテゴリ名].[アプリケーション名].test` のようにするケースもあり得るからだ。

`[ユニット名]`、 `[サブユニット名]`、`[アプリケーション名]` はそれぞれ区別できるような名前にすること。

同じ役割を持つアプリケーションが一つしか存在しない場合、 `[ユニット名]` は省略しても良い。

* 例: `redis.test` 、 `dape.test` 、 `db.test` はそれぞれ Redis、Dape、データベースエンジンを指す。

#### 7.2. アプリケーションが水平スケーリングされている場合

同じ役割を持つアプリケーションが複数存在する場合は、以下のようにする。

役割が非対称であるために区別する必要がある場合は、役割をユニット名に含めること。

* 例: ActivityPub のパケット FFI モジュールの相互受信をテストするためのサーバーのドメイン名に、それぞれ `incoming.ap-proxy.test`、`outgoing.ap-proxy.test` と名前をつける。

役割が対称であるなどの理由で区別する必要がない場合は、最も先頭に来るレベルにおいてNATOフォネティックコードを利用して順序ごとに名前をつけること。

* 例: Dape の ActivityPub モジュールの相互通信テストにおいて、 `alpha.dape.test` 及び `bravo.dape.test` を使用する。

### 8. 例示のために `.xxx` TLD を使用しない

`.xxx` TLD は実在する[^3]。そのため、IPv4の例示や、IPv4のマスクなどの目的で `.xxx` をドメイン名として解釈され得る形で使用することは禁止する。

以下に、代案を提示する。

* IPv4を例示するならプライベートIPアドレスを使用すること。
* IPv4をマスクする必要がある場合は半角アスタリスク (`*`) を使用すること。

※背景：IPv4アドレスをマスクしようとして自動リンクで実在するドメインにリンクされる事故が多いため。

### 9. 例示のために `.dev` や `.app` を使用しない

`.dev` TLD や `.app` TLD はどちらも存在する。そのため、例示に用いることを禁止する。

特に、 `.dev` TLD は開発環境で用いてはならない。

### 10. 例示のために `.onion` を使用しない

`.onion` TLD は [IETF RFC 7686] で予約されているが、その目的は Tor プロジェクトのためなので、例示に用いることを禁止する。

### 11. 例示のために `.arpa` を使用しない

`.arpa` TLD はインフラ専用のTLDであるため、例示には使用を禁止する。

## X. 参考

* [IETF RFC 2606]
* [IETF RFC 6761]
* [ブランドTLD一覧 - domainname.jp](https://domainname.jp/report/brand_tld_list)

[IETF RFC 2606]: https://datatracker.ietf.org/doc/html/rfc2606#section-2
[IETF RFC 6761]: https://datatracker.ietf.org/doc/html/rfc6761#section-6.5
[IETF RFC 7686]: https://datatracker.ietf.org/doc/html/rfc7686

[^1]: [IETF RFC 6761]
[^2]: https://jprs.jp/faq/use/
[^3]: https://icannwiki.org/.xxx
